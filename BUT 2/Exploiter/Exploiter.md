<link rel="stylesheet" href="../style.css">

### Aksel

### CAUBEL

#### RT2 IOM

<h1 class=headerTemplate style="text-align:center;">Exploiter</h1>

<# Intégrer des systèmes d'exploitation embarqués

# Mettre en oeuvre des protocoles pour les réseaux

Dans le contexte de l'Internet Des Objets, j'ai pu mettre en oeuvres des protocoles de communication à différent dégré mais j'estime que la mise en place des protocoles utilisés n'est pas suffisante pour l'appeler comme tel mais plutôt l'utilisation des protocoles avec une configuration standard.

Dans les protocoles utilisés on va retrouver en première place le protocole MQTT :

MQTT marche sous la forme de subcriber/providers en passant par un broker MQTT qui va géré la redistribution des flux de donnée.

Pour l'exemple je parlerai de Mosquitto qui est le seul broker que j'ai utilisé jusqu'à maintenant il est très simple a mettre en oeuvre pour sa version de base. Il suffit juste de l'installer et pour le sécuriser les connexion, interdire les utilisateurs **anonymes**. Je n'ai pas encore fait passer le protocole sous sa forme "sécurisé" mais cela se fera durant l'année.

Afin de faire une configuration standard pour MQTT qui est un protocole fonctionnant sur le port 1883 pour sa version non sécurisé il suffit de crée un fichier de stockage pour les mots de passe, et mettre dans le fichier de configuration c'est quelque ligne : 

```c#
listener 1883 // Permet de définir le port d'écoute
allow_anonymous false // interdit les utilisateurs non connectés
password_file /etc/mosquitto/passwd // indique le fichier de stockage des mots de passe
```

Le protocole LoRa / LoRaWAN :

Le protocole HTTP : 

# Mettre en oeuvre des applications et traiter des données issues des objets connectés

Pour vous parlez d'une application IOT concrète:
Lors de mon apprentissage aux seins de la Menuiserie Carayon, j'ai pu et je continue de développer une application IOT nommé VNA-systeme pour Ventilation Naturelle Autonome. Elle consiste à améliorer la qualité de l'air intérieur grâce a des fenêtres intelligeante qui s'ouvre en cas de forte concentration de CO2. Le système comprend divers capteurs lui permettant de faire face à toute condition. Cette application est également crée avec un autre apprenti : PUIG Mathieu

Cette application à nécéssiter des choix importants, d'autant plus que nous travaillons en collaboration avec des menuisiers qui fabriquent les fenêtres ainsi que des dessinateurs pour la création de certaines pièces. 

L'application pour sa première version est représentable de cette manière :

Des capteurs de Température / PPM (Co2) / Pression atmosphérique / Humidité sont disposés chez des clients.
La donnée est remonté via le protocole de communication LoRaWAN jusqu'à un VPC dans le cloud contenant un Application Network et un Server Network (ChirpStack port de fonctionnement 1700). Un Network Server est un service permettant de géré la partie de la communication LoRaWAN en gérant sa fréquence, en fesant attention aux collisions etc... Un Application Server quand a lui permet de faire le lien entre les devices et la retranmission de la donnée pour les différentes applications. Ici les données seront envoyé par l'application Server vers un broker MQTT de type Mosquitto (port de fonctionnement 1883/8883->MQTTS).

Un premier décodage est fait pour ensuite être renvoyé sur un nouveau sujet MQTT qui sera écouté par un un service "MQTT_Collector" fait en python par mes soins. Ce dernier permet que la donnée soit analysée pour en faire une gestion d'erreurs ainsi que l'envoyer sur notre base de donnée de type InfluxDB ( port de fonctionnement 8086). Ce système de MQTT_Collector aurait pu se faire avec Telegraph, une application courante de scrapping pour récolter les données sur InfluxDB mais pour des raisons de contrôle et de gestion avec tous les degrés de liberté possible, nous avons fait le choix de crée nous même se système. 

Ce dernier point possède une faiblesse. Je me base sur des bibliothèques qui un jour peuvent être changé. Cela obligera donc une refonte du MQTT-Collector alors que Telegraph lui permettrai un utilisation avec moins de risque de ce côté puisqu'il sagit d'une application généraliste. Les deux possèdent des pour et des contres. Mais pour cette version le choix de la création personnel a été faite dans le but ne pas être bloqué par des lignes de code invisible et pouvoir crée notre propre chemin correspondant a nos besoins comme redistribuer des données a nos fenetres en fonction de ce que l'on reçoit comme information.

Une fois l'enregistrement des données faites il nous suffit d'une interface Homme-Machine pour que notre boucle soit bouclé.

Etat donné que nous somme sur un projet et nous avons une dead-line courant Février nous avons du presser le pas. Et pour crée cette interface Homme-Machine nous sommes partie de connaissance. N'aillant pas le temps de se former en un lapse de temps aussi court au langage de programmation Java ainsi qu'à React, qui aurait été notre premier choix technologique. Nous sommes parti sur la solution de Django. Aillant déjà eux une première expérience en Django nous avons pu démarrer rapidement le développement du site.

Pour le site nous avons opté pour l'utilisation d'une deuxième base de donnée avec une manière d'ordonnée les données différentes et plus adéquois : PostgreSQL.

La façon de stockage des données n'est pas comme InfluxDB. InfluxDB va être un choix IOT très intéressant puisque les Clées Primaires sont le **temps** mais pour une utilisation de stockage des utilisateurs ou autres données d'un site WEB, l'utilisation d'une base de donnée pouvant utiliser un Identifiant comme Clées Primaires est plus intéressante.

Comme dit précédement nous utilisons Django, cette application est donc crée en python sous forme de models, de vues et de templates.

Cette partie de application permet de visualisée les informations clées de l'air ambiant d'une pièce. Cela permet d'avoir un suivit de la température et de la qualité de l'air grâce au CO2.


Extrait du site :

<img style="width:100%;" src="./image/vna-systeme_web_extrait.JPG"/>


Pour les différents graphiques nous utilisons un bibliothèque faite en Java-Script qui les génèrent automatiquement à partir des données influxDB qu'on lui retransmet.

Une autre partie de l'application concerne plus particulièrement la sécurité et le confort de le l'usagé. 

<img style="width:100%;" src="./image/vna-systeme_web_detail_extrait.JPG"/>

Cette page qui est toujours en cours de développement en ce qui concerne le design, Permet de visualiser à distance l'information s'il pleut ou non ainsi que de la vitesse du vent à cette endroit. Mais on pourra y retrouver également l'état des fenêtres installées chez les clients avec l'unique possibilité de lancer une action de fermeture si la fenêtre n'est pas fermé et que nous souhaitons tout de même la fermer.
Les données de pluie est de vent sont très importantes car nous ne souhaitons pas innondé un batiment n'y même faire voler les papiers d'un bureau.

Pour notre première version nos fenêtres d'oté d'ESP-32 communiqueront par WiFi avec le protocole MQTT.

Par la suite une évolution sur du LoRaWAN devra être mit en place.


